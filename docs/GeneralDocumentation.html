<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MASFENON: General framework documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MASFENON
   </div>
   <div id="projectbrief">Multi-Agent Adaptive Simulation Framework for Evolution in Networks of Networks</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">General framework documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md2"></a>
Framework Documentation</h1>
<p>This part of the documentation serves as a practical guide for users who wish to explore the technical details of the <b>MASFENON</b> framework and learn how to operate it effectively. Here we provide an overview of MASFENON usage, including:</p>
<ul>
<li>Running MASFENON with the provided scripts.</li>
<li>Understanding and configuring simulation parameters.</li>
<li>Addressing common deployment issues, such as running MPI in local builds.</li>
<li>Notes on parallel execution and hardware considerations.</li>
</ul>
<p>The purpose of this section is not only to document operational procedures, but also to support reproducibility of the experiments described in the thesis and to help future users adapt MASFENON to their own research use cases.</p>
<p>For readers seeking more in-depth technical documentation of the internal implementation (class structures, methods, source code references, etc.), the complete and always up-to-date <b>Doxygen-generated documentation</b> is publicly available at:</p>
<p>ðŸ‘‰ <a href="https://josura.github.io/MASFENON/">https://josura.github.io/MASFENON/</a></p>
<p>This online resource provides detailed developer-oriented documentation, including C++ class hierarchies, function descriptions, code examples, and internal module dependencies. It is recommended for advanced users and developers intending to extend the framework or integrate it into custom workflows.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md4"></a>
B.1 Introduction</h2>
<p><b>MASFENON</b> (Multiagent Adaptive Simulation Framework for Evolution in Networks of Networks) is a standalone simulation framework designed to handle complex dynamic systems through modular multi-agent interaction. It was originally developed as part of the <b>c2c-sepia</b> project and has now been extracted as a clean, optimized version.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
B.1.1 Dependencies</h3>
<ul>
<li><a href="https://arma.sourceforge.net/">Armadillo</a></li>
<li>MPI implementation (tested on <a href="https://www.open-mpi.org">OpenMPI</a>)</li>
<li><a href="https://www.boost.org/">Boost</a> â€” ensure <code>program_options</code> is installed if needed</li>
</ul>
<h3><a class="anchor" id="autotoc_md6"></a>
B.1.2 File Structure</h3>
<div class="fragment"><div class="line">.</div>
<div class="line">\|-- CMakeLists.txt           # CMake build configuration</div>
<div class="line">\|-- examples.md              # Usage and plotting examples</div>
<div class="line">\|-- .github/                 # CI workflows</div>
<div class="line">\|-- build/                   # Build output</div>
<div class="line">\|-- src/                     # Source code</div>
<div class="line">\|-- data/                    # Sample/test datasets</div>
<div class="line">\-- scripts/                  # Bash and Python helper scripts</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7"></a>
B.1.3 Build</h3>
<div class="fragment"><div class="line">cmake -B build</div>
<div class="line">cd build</div>
<div class="line">make</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md8"></a>
B.1.4 Usage</h3>
<p><b>Help Message:</b></p>
<div class="fragment"><div class="line">./build/masfenon-MPI --help</div>
</div><!-- fragment --><p><b>Example Run:</b></p>
<div class="fragment"><div class="line">./build/masfenon-MPI \</div>
<div class="line">  --fUniqueGraph graph.tsv \</div>
<div class="line">  --fInitialPerturbationPerType matrix.tsv \</div>
<div class="line">  --typeInteractionFolder typesInteractionFolder/</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md9"></a>
B.1.5 Parameter Customization</h3>
<p>Custom scaling functions (dissipation, conservation, etc.) can be modified in <code>src/CustomFunctions</code>.</p>
<h3><a class="anchor" id="autotoc_md10"></a>
B.1.6 Propagation Function Customization</h3>
<p>Propagation functions can be customized in <code>src/computation/PropagationModelCustom</code>.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
B.1.7 License</h3>
<p>This project is released under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
<p>For issues, please use the GitHub issues page: <a href="https://github.com/josura/MASFENON/issues">https://github.com/josura/MASFENON/issues</a></p>
<hr  />
<h2><a class="anchor" id="autotoc_md13"></a>
B.2 Inputs and Parameters of the Framework</h2>
<p>This section documents the command-line interface (CLI) inputs, expected file formats, and configuration parameters of the <b>MASFENON</b> framework. Options are provided via Boost.Program_options. Boolean switches are disabled by default unless explicitly set.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
B.2.1 Data Inputs and File Formats</h3>
<p>At minimum, the framework requires:</p>
<ul>
<li>A graph (unique file or a folder of graphs), and</li>
<li>An initial perturbation matrix (unique file or a folder of matrices).</li>
</ul>
<p>Exactly one of the following must be specified for graphs:</p>
<ul>
<li><code>--fUniqueGraph &lt;file&gt;</code> <b>OR</b> <code>--graphsFilesFolder &lt;folder&gt;</code></li>
</ul>
<p>Exactly one of the following should be specified for perturbations:</p>
<ul>
<li><code>--fInitialPerturbationPerType &lt;file&gt;</code> <b>OR</b> <code>--initialPerturbationPerTypeFolder &lt;folder&gt;</code></li>
</ul>
<p>Optionally, inter-type interactions, node descriptions, and a list of subtypes can be provided.</p>
<h4><a class="anchor" id="autotoc_md15"></a>
File Schemas</h4>
<p><b>Graph (edge list):</b> <code>graph.tsv</code></p>
<div class="fragment"><div class="line">start    end    weight</div>
<div class="line">geneA    geneB  0.123</div>
<div class="line">...</div>
</div><!-- fragment --><p><b>Initial perturbation (homogeneous):</b> <code>initialPerturbationHomogeneous.tsv</code></p>
<div class="fragment"><div class="line">name    type1          type2        ...    typeN</div>
<div class="line">gene1   lfc_type1:g1   lfc_type2:g1 ...    lfc_typeN:g1</div>
<div class="line">gene2   lfc_type1:g2   lfc_type2:g2 ...    lfc_typeN:g2</div>
<div class="line">...</div>
</div><!-- fragment --><p><b>Initial perturbation (heterogeneous):</b> <code>initialPerturbation-typeN.tsv</code></p>
<div class="fragment"><div class="line">name    value</div>
<div class="line">gene1   lfc_typeN:g1</div>
<div class="line">gene2   lfc_typeN:g2</div>
<div class="line">...</div>
</div><!-- fragment --><p><b>Inter-type interactions:</b> <code>typesInteraction.tsv</code></p>
<div class="fragment"><div class="line">startType  startNodeName  endType  endNodeName  weight</div>
<div class="line">type0      gene-e         type1    gene-a       1.0</div>
<div class="line">...</div>
</div><!-- fragment --><p><b>Subtypes list (optional):</b> <code>subtypes.txt</code></p>
<div class="fragment"><div class="line">type1</div>
<div class="line">type3</div>
<div class="line">...</div>
</div><!-- fragment --><p><b>Node descriptions (optional)</b>:</p>
<ul>
<li>Single file: <code>--nodeDescriptionFile &lt;file&gt;</code></li>
<li>Per-graph folder: <code>--nodeDescriptionFolder &lt;folder&gt;</code></li>
</ul>
<p>Each file should list node identifiers (and optionally annotations). If not provided, nodes are inferred from edges.</p>
<hr  />
<h3><a class="anchor" id="autotoc_md17"></a>
B.2.2 Input Locations</h3>
<ul>
<li><code>--fUniqueGraph &lt;string&gt;</code></li>
<li><code>--graphsFilesFolder &lt;string&gt;</code></li>
<li><code>--fInitialPerturbationPerType &lt;string&gt;</code></li>
<li><code>--initialPerturbationPerTypeFolder &lt;string&gt;</code></li>
<li><code>--typeInteractionFolder &lt;string&gt;</code></li>
<li><code>--nodeDescriptionFile &lt;string&gt;</code></li>
<li><code>--nodeDescriptionFolder &lt;string&gt;</code></li>
<li><code>--subtypes &lt;string&gt;</code></li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md19"></a>
B.2.3 Dynamics and Time Discretization</h3>
<ul>
<li><code>--intratypeIterations &lt;int&gt;</code></li>
<li><code>--intertypeIterations &lt;int&gt;</code></li>
<li><code>--timestep &lt;double&gt;</code> â†’ Î”t Total simulated time: <code>T = I_inter Ã— Î”t</code></li>
<li><code>--quantizationMethod &lt;string&gt;</code> (<code>single</code> or <code>multiple</code>)</li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md21"></a>
B.2.4 Physical/Computational Models and Parameters</h3>
<p><b>Dissipation</b></p>
<ul>
<li><code>--dissipationModel &lt;string&gt;</code>: <code>none | power | random | periodic | scaled | custom</code></li>
<li><code>--dissipationModelParameters &lt;vector&lt;double&gt;&gt;</code></li>
</ul>
<p><b>Conservation</b></p>
<ul>
<li><code>--conservationModel &lt;string&gt;</code>: <code>none | scaled | random | custom</code></li>
<li><code>--conservationModelParameters &lt;vector&lt;double&gt;&gt;</code></li>
</ul>
<p><b>Propagation</b></p>
<ul>
<li><code>--propagationModel &lt;string&gt;</code>: <code>default | scaled | neighbors | customScaling | customScalingNeighbors | customPropagation</code></li>
<li><code>--propagationModelParameters &lt;vector&lt;double&gt;&gt;</code></li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md23"></a>
B.2.5 Saturation and Norm Constraints</h3>
<ul>
<li><code>--saturation</code></li>
<li><code>--saturationTerm &lt;double&gt;</code> â†’ bounds [-s, s]</li>
<li><code>--customSaturationFunction</code></li>
<li><code>--conservateInitialNorm</code></li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md25"></a>
B.2.6 Topology and Virtual Nodes</h3>
<ul>
<li><code>--undirectedEdges</code></li>
<li><code>--undirectedTypeEdges</code></li>
<li><code>--sameTypeCommunication</code></li>
<li><code>--virtualNodesGranularity &lt;string&gt;</code> (<code>type</code>, <code>node</code>, <code>typeAndNode</code>)</li>
<li><code>--virtualNodesGranularityParameters &lt;vector&lt;string&gt;&gt;</code></li>
<li><code>--resetVirtualOutputs</code></li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md27"></a>
B.2.7 Logging, Robustness, and Runtime Controls</h3>
<ul>
<li><code>--loggingOptions &lt;string&gt;</code>: <code>all</code> (default) or <code>none</code></li>
<li><code>--verbose</code></li>
<li><code>--treatWarningAsError</code></li>
<li><code>--resumeCheckpoint</code></li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md29"></a>
B.2.8 Outputs and Performance Tracking</h3>
<ul>
<li><code>--outputFolder &lt;string&gt;</code></li>
<li><code>--outputFormat &lt;string&gt;</code> (<code>singleIteration</code> or <code>iterationMatrix</code>)</li>
<li><code>--saveAugmentedNetworks</code></li>
<li><code>--savePerformance &lt;string&gt;</code></li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md31"></a>
B.2.9 Example CLI Invocation</h3>
<div class="fragment"><div class="line">./masfenon-MPI \</div>
<div class="line">  --fUniqueGraph data/testdata/testGraph/edges-Graph1-general.tsv \</div>
<div class="line">  --fInitialPerturbationPerType data/testdata/testGraph/initialValues-general.tsv \</div>
<div class="line">  --typeInteractionFolder data/testdata/testHeterogeneousGraph/interactions \</div>
<div class="line">  --intratypeIterations 20 \</div>
<div class="line">  --intertypeIterations 10 \</div>
<div class="line">  --timestep 0.1 \</div>
<div class="line">  --propagationModel scaled \</div>
<div class="line">  --propagationModelParameters 0.8 \</div>
<div class="line">  --dissipationModel power \</div>
<div class="line">  --dissipationModelParameters 0.95 \</div>
<div class="line">  --conservationModel scaled \</div>
<div class="line">  --conservationModelParameters 0.9 \</div>
<div class="line">  --saturation --saturationTerm 1.0 \</div>
<div class="line">  --undirectedEdges --undirectedTypeEdges \</div>
<div class="line">  --outputFolder out/run1 \</div>
<div class="line">  --outputFormat iterationMatrix \</div>
<div class="line">  --savePerformance out/run1/perf.tsv \</div>
<div class="line">  --loggingOptions all --verbose</div>
</div><!-- fragment --><hr  />
<h3><a class="anchor" id="autotoc_md33"></a>
B.2.10 Tabular Summary of Options</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>fUniqueGraph</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Single graph file; XOR with <code>graphsFilesFolder</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>graphsFilesFolder</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Folder of graphs.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>fInitialPerturbationPerType</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Single perturbation file.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>initialPerturbationPerTypeFolder</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Folder of perturbation files.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>typeInteractionFolder</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Inter-type edges folder.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>nodeDescriptionFile</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Node names (common graph).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>nodeDescriptionFolder</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Node names (per-graph).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>subtypes</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Optional subtype list.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>intratypeIterations</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">&gt;0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>intertypeIterations</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">&gt;0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>timestep</code>   </td><td class="markdownTableBodyNone">double   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Î”t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>quantizationMethod</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">single | multiple    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>dissipationModel</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">none   </td><td class="markdownTableBodyNone">See list above.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>dissipationModelParameters</code>   </td><td class="markdownTableBodyNone">vector&lt;double&gt;   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Model-dependent.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>conservationModel</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">none   </td><td class="markdownTableBodyNone">See list above.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>conservationModelParameters</code>   </td><td class="markdownTableBodyNone">vector&lt;double&gt;   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Model-dependent.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>propagationModel</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">default   </td><td class="markdownTableBodyNone">See list above.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>propagationModelParameters</code>   </td><td class="markdownTableBodyNone">vector&lt;double&gt;   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Model-dependent.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>saturation</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Enable clipping.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>saturationTerm</code>   </td><td class="markdownTableBodyNone">double   </td><td class="markdownTableBodyNone">1.0   </td><td class="markdownTableBodyNone">Requires <code>--saturation</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>customSaturationFunction</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">User-defined.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>conservateInitialNorm</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Norm constraint.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>undirectedEdges</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Intra-graph undirected.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>undirectedTypeEdges</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Inter-type undirected.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>sameTypeCommunication</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Same-type virtual node.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>resetVirtualOutputs</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Zeroed each iteration.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>virtualNodesGranularity</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">type   </td><td class="markdownTableBodyNone">type | node | typeAndNode    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>virtualNodesGranularityParameters</code>   </td><td class="markdownTableBodyNone">vector&lt;string&gt;   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Reserved.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>loggingOptions</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">all   </td><td class="markdownTableBodyNone">all | none    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>verbose</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Extra logs.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>treatWarningAsError</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Fail on warning.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>resumeCheckpoint</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Resume run.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>outputFolder</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">â€”   </td><td class="markdownTableBodyNone">Required for outputs.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>outputFormat</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">singleIteration   </td><td class="markdownTableBodyNone">Iteration output mode.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>saveAugmentedNetworks</code>   </td><td class="markdownTableBodyNone">flag   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Save augmented graphs.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>savePerformance</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">Save runtime summary.   </td></tr>
</table>
<hr  />
<h3><a class="anchor" id="autotoc_md35"></a>
B.2.11 Additional considerations</h3>
<p>If there are problems with the options, file, or consistency, the program will throw exceptions with explanatory error messages, or print warnings. Use <code>--verbose</code> for more details.</p>
<h2><a class="anchor" id="autotoc_md36"></a>
B.3 Fitting Procedure and Scripts</h2>
<p>In addition to the general-purpose simulation parameters, <b>MASFENON</b> includes a dedicated fitting workflow for calibrating the simulation to experimental single-cell data. In the current implementation, this process has been applied to fit the model to the <em>AT1</em> cell metabolite layer in scRNA-seq data.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
B.3.1 Overview</h3>
<p>The fitting pipeline iteratively adjusts the <b>dissipation</b>, <b>propagation</b>, and <b>conservation</b> model parameters to minimize the mean squared error (MSE) between simulated outputs and experimental data at specific timepoints. The process is controlled by a main Bash script, which:</p>
<ol type="1">
<li>Sets the fitting mode (manual parameter ranges or resume from previous results).</li>
<li>Runs multiple <b>epochs</b>, each consisting of:<ul>
<li>Executing the MASFENON simulation with the current parameter ranges.</li>
<li>Computing MSE values for each experiment/timepoint.</li>
<li>Generating updated parameter ranges for the next epoch, based on MSE ranking.</li>
</ul>
</li>
<li>Saves all intermediate results, MSE tables, and updated parameter ranges in a user-defined output folder.</li>
</ol>
<h3><a class="anchor" id="autotoc_md38"></a>
B.3.2 Required Scripts</h3>
<p>The fitting workflow depends on the following scripts:</p>
<ul>
<li>**<code>simulation_custom_parameters.sh</code>** <br  />
 Runs a MASFENON simulation with explicit dissipation, propagation, and conservation parameter ranges. <br  />
 Parameters: <br  />
 <div class="fragment"><div class="line">minDiss maxDiss dissSteps minProp maxProp propSteps minCons maxCons consSteps</div>
</div><!-- fragment --></li>
<li>**<code>compute-MSE-metabolites.py</code>** <br  />
 Computes the MSE between simulation outputs and experimental data for each available timepoint (e.g., 6h, 7h, 10h). <br  />
 Outputs an MSE-sorted table in the format: <div class="fragment"><div class="line">MSE    experiment</div>
<div class="line">0.012  dissipation\_&lt;d&gt;-propagation\_&lt;p&gt;-conservation\_&lt;c&gt;</div>
<div class="line">...</div>
</div><!-- fragment --> This script is part of the <a href="https://github.com/josura/c2c-sepia">c2c-sepia repository</a>.</li>
<li>**<code>createNewParametersFromMSEtable.sh</code>** <br  />
 Reads an MSE table and generates new parameter ranges around the best-performing configurations, for use in the next fitting epoch.</li>
</ul>
<h3><a class="anchor" id="autotoc_md39"></a>
B.3.3 Execution Modes</h3>
<p>The main fitting script supports two execution modes:</p>
<p><b>Manual Range Mode</b> </p><div class="fragment"><div class="line">./fit-and-run-simulation.sh &lt;epochs&gt; &lt;OutputFolder&gt; &lt;minParam&gt; &lt;maxParam&gt; &lt;intervals&gt;</div>
</div><!-- fragment --><p>All three parameter families (dissipation, propagation, conservation) share the same starting min, max, and number of intervals.</p>
<p><b>Resume Mode</b></p>
<div class="fragment"><div class="line">./fit-and-run-simulation.sh &lt;epochs&gt; &lt;OutputFolder&gt;</div>
</div><!-- fragment --><p>Reads previous simulation results from <code>&lt;OutputFolder&gt;</code>, computes the MSE tables, and generates new ranges from them. Useful to continue fitting without restarting from scratch.</p>
<h3><a class="anchor" id="autotoc_md40"></a>
B.3.4 Epoch Loop and Parameter Update</h3>
<p>Each epoch proceeds as follows:</p>
<ol type="1">
<li>Create an <code>epoch_&lt;n&gt;</code> subfolder inside <code>&lt;OutputFolder&gt;</code>.</li>
<li><p class="startli">Run the simulation with current parameter ranges:</p>
<div class="fragment"><div class="line">bash simulation_custom_parameters.sh \</div>
<div class="line">    minDiss maxDiss dissSteps \</div>
<div class="line">    minProp maxProp propSteps \</div>
<div class="line">    minCons maxCons consSteps</div>
</div><!-- fragment --></li>
<li><p class="startli">Compute MSE values for each timepoint:</p>
<div class="fragment"><div class="line">python3 compute-MSE-metabolites.py epoch_&lt;n&gt;</div>
</div><!-- fragment --></li>
<li><p class="startli">From the MSE table of the selected fitting timepoint (e.g., 10h), extract top configurations and generate updated parameter ranges:</p>
<div class="fragment"><div class="line">bash createNewParametersFromMSEtable.sh \</div>
<div class="line">    epoch_&lt;n&gt;/mse_10h.tsv \</div>
<div class="line">    5 \</div>
<div class="line">    &lt;intervals&gt; \</div>
<div class="line">    epoch_&lt;n&gt;/newParams_mse_10h.txt</div>
</div><!-- fragment --></li>
<li>Update <code>min</code>, <code>max</code>, and <code>intervals</code> for each parameter family from the generated file.</li>
</ol>
<h3><a class="anchor" id="autotoc_md41"></a>
B.3.5 Environment Requirements</h3>
<p>The fitting process requires:</p>
<ul>
<li><p class="startli">A Python virtual environment with dependencies for <code>compute-MSE-metabolites.py</code>. The main script activates it via:</p>
<div class="fragment"><div class="line">source /path/to/venv/bin/activate</div>
</div><!-- fragment --></li>
<li>The <a href="https://github.com/josura/c2c-sepia">c2c-sepia repository</a> for MSE computation scripts.</li>
<li>The <b>MASFENON</b> repository for simulation scripts.</li>
</ul>
<h3><a class="anchor" id="autotoc_md42"></a>
B.3.6 Outputs</h3>
<p>For each epoch, the output folder contains:</p>
<ul>
<li>Simulation outputs from the current parameters.</li>
<li>MSE tables for all fitted timepoints.</li>
<li>Updated parameter range files for the next epoch.</li>
</ul>
<h3><a class="anchor" id="autotoc_md43"></a>
B.3.7 Example Run</h3>
<p>Example: 3-epoch manual range fitting starting from 0.1â€“1.0 with 5 intervals:</p>
<div class="fragment"><div class="line">./fit-and-run-simulation.sh 3 out_fitting 0.1 1.0 5</div>
</div><!-- fragment --><p>The final MSE results and the best parameters are stored in <code>out_fitting</code>.</p>
<h3><a class="anchor" id="autotoc_md44"></a>
B.3.8 Per-Node Error-Based Adjustment Script</h3>
<p>In addition to the global fitting workflow, a second (non-public) script exists for fine-grained parameter tuning. Instead of computing MSE on aggregated outputs, this script:</p>
<ol type="1">
<li>Selects a specific network or subnetwork.</li>
<li>Computes error <b>per individual node</b> with respect to experimental data.</li>
<li>Aggregates per-node errors to identify parameter sensitivities.</li>
<li>Adjusts dissipation, propagation, and conservation parameters independently.</li>
</ol>
<p>This method is useful for:</p>
<ul>
<li>Networks with heterogeneous dynamics.</li>
<li>Subsets of nodes representing critical biological processes.</li>
<li>Iterative localized parameter tuning.</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md46"></a>
B.4 Visualization</h2>
<p>In addition to numerical outputs, <b>MASFENON</b> includes interactive visualization tools for exploring simulation results.</p>
<p>Two visualization scripts are available:</p>
<ol type="1">
<li>A single-network plotter for node time series (in <code>c2c-sepia/scripts/python/temporalSingleCell/plotResults_withLR.py</code>).</li>
<li>A web-based multi-network explorer using Flask and Plotly (in <code>MASFENON/scripts/python/visualization/visualizationWebPageComplete.py</code>).</li>
</ol>
<h3><a class="anchor" id="autotoc_md47"></a>
B.4.1 Web Application for Multi-Network Visualization</h3>
<p>This tool provides an interactive web interface for visualizing all simulated networks and their temporal evolution. Implemented in <b>Flask</b> and <b>Plotly</b>, it allows:</p>
<ul>
<li>Selecting a network (<em>type</em>) from outputs.</li>
<li>Selecting a timepoint to visualize.</li>
<li>Inspecting node attributes and edge weights interactively.</li>
<li>Color mapping and node size scaling based on values.</li>
</ul>
<h4><a class="anchor" id="autotoc_md48"></a>
B.4.1.1 Data Sources</h4>
<p>The app uses:</p>
<ol type="1">
<li><b>Iteration matrices</b>: <code>&lt;OutputDirectory&gt;/&lt;type&gt;.tsv</code></li>
<li><b>Augmented graph files</b>: <code>&lt;AugmentedGraphDirectory&gt;/&lt;type&gt;.tsv</code></li>
<li><b>Initial node values</b>: <code>&lt;InputValuesDirectory&gt;/&lt;type&gt;.tsv</code></li>
</ol>
<h4><a class="anchor" id="autotoc_md49"></a>
B.4.1.2 Preprocessing and Caching</h4>
<p>At startup, the app:</p>
<ul>
<li>Reads all <code>.tsv</code> output files.</li>
<li>Loads node value series and graph structure.</li>
<li>Generates a static <b>networkx spring layout</b>.</li>
<li>Creates Plotly traces for edges and nodes for every timepoint.</li>
<li>Saves pickled caches:<ul>
<li><code>node_traces_for_networks.pkl</code></li>
<li><code>edge_traces_for_networks.pkl</code></li>
<li><code>dict_for_plot.pkl</code></li>
</ul>
</li>
</ul>
<h4><a class="anchor" id="autotoc_md50"></a>
B.4.1.3 Server Routes</h4>
<ul>
<li><code>/</code> â†’ main interface with slider</li>
<li><code>/read_types</code> â†’ list of network types</li>
<li><code>/types/&lt;type&gt;</code> â†’ set active network</li>
<li><code>/plot/&lt;timepoint&gt;</code> â†’ figure JSON for current type at timepoint</li>
<li><code>/plot_singular/&lt;type&gt;/&lt;timepoint&gt;</code> â†’ figure JSON for specific type/timepoint</li>
</ul>
<h4><a class="anchor" id="autotoc_md51"></a>
B.4.1.4 Visualization Details</h4>
<ul>
<li><b>Edges</b>: thin gray lines (<code>#888</code>), hover = weight</li>
<li><b>Nodes</b>: <code>YlGnBu</code> reversed scale, size âˆˆ [4,22]</li>
<li><b>Layout</b>: fixed <code>spring_layout</code></li>
<li><b>Annotations</b>: fixed parameter settings shown</li>
</ul>
<h4><a class="anchor" id="autotoc_md52"></a>
B.4.1.5 Workflow Summary</h4>
<div class="fragment"><div class="line">python3 visualizationWebPageComplete.py</div>
</div><!-- fragment --><p>Then open <a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a> in a browser.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md54"></a>
B.5 Legacy Framework: c2c-SEPIA</h2>
<p>Before the standalone release of <b>MASFENON</b>, its initial development and related experiments, scripts, and input preparation pipelines were maintained in the <a href="https://github.com/josura/c2c-sepia">c2c-sepia repository</a>.</p>
<p>This legacy repository still contains:</p>
<ul>
<li>Original MASFENON source code (pre-migration).</li>
<li>Scripts for single-cell experiments.</li>
<li>Utilities for image documentation.</li>
<li>Example datasets and workflows for cell-to-cell communication (CCC) simulations.</li>
</ul>
<p>It was designed for <b>cell-to-cell communication simulations with enriched pathways</b>, using annotated scRNA-seq data and multi-agent system (MAS) principles, extended with parallel and distributed computation.</p>
<p>Dependencies and build process are nearly identical to MASFENON. The legacy repo now mainly contains domain-specific scripts for CCC simulation.</p>
<h3><a class="anchor" id="autotoc_md55"></a>
Additional Scripts and Utilities</h3>
<p>The <b>MASFENON</b> repository also provides scripts for:</p>
<ul>
<li>Input dataset generation (biological, epidemiological, etc.).</li>
<li>Preprocessing pipelines for single-cell data (including missing-data handling).</li>
<li>Scenario-specific transformations and format conversions.</li>
</ul>
<p>These are <b>not detailed here</b> since:</p>
<ul>
<li>Input preparation was already described in the main text.</li>
<li>Scripts are documented in other research articles and repository <code>README</code> files.</li>
</ul>
<p>For comprehensive instructions, refer to those sources. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
